import EndpointParser from '@site/src/components/EndpointParser';

<EndpointParser json="{
    &quot;tag&quot;: {
        &quot;name&quot;: &quot;Webhook Request&quot;,
        &quot;description&quot;: &quot;After creating a webhook you can listen to events that occur in your Lune Account. This enables you to react to these events. Think of a webhook as a way to get notifications of activity that happens in your account.\n\nAPI calls are a mechanism for *you*, the API client, to send requests to Lune (for example to place an\norder). Webhooks are a mechanism for Lune to send notifications to you, right when a relevant event happens,\nwithout you having to repeatedly call the API and ask for the information (which is wasteful in terms\nof resources).\n\nCurrently, webhooks events are limited to order status changes that changes in your account (an event is generated whenever an order status changes).\n\nYour webhook endpoint has to respond with a 2xx HTTP status code within 30 seconds. If we don&#x27;t get a 2xx status code or the request times out we will treat is as failure and try to resend it with a delay.\n\nThe events sent to the webhook endpoint are batched – we send multiple events in a single request.\nThere&#x27;s a limit to the number of events we send at once, if there are more events waiting to be sent\nwe only send a number of the oldest ones.\n\n# Delivery guarantees\n\n* Events are always delivered in the order they happened from the point of view of Lune&#x27;s systems.\n  The order may not be obvious when multiple actions are performed concurrently (for example when\n  you place multiple orders at the same time you can&#x27;t know which order will generate events first).\n* Particularly, order events corresponding to one order are always delivered in the order\n  consistent with the transitions described in the \&quot;Order status and lifecycle\&quot; documentation section.\n* Events are always delivered in the same order (this concerns retries).\n* Events are delivered at least once – they may be tried to be delivered multiple times\n  if there were earlier attemps that failed (either because of a communication error or a non-2xx HTTP\n  status code). If you endpoint responds with a 2xx status code there&#x27;s no guarantee that the response\n  will be registered by Lune&#x27;s systems – the response may be lost in transit.\n* Lune only attempts one request to your webhook endpoint at a time. There are some caveats:\n\n  * If we successfully manage to send a request but the communication is interrupted before we get\n    a response we have no way to know if the request reached your webhook endpoint.\n  * If the 30 second timeout is reached we abandon the request on our side but we have no way\n    of ensuring that the processing of the request on your side isn&#x27;t continuing.\n\n  With that in mind, if you depend on there being strictly one and only one webhook request being\n  processed at any given time it&#x27;s your responsibility to ensure that.\n\n# Idempotency\nIt is necessary to handle the same events being delivered multiple times (for the reasons mentioned\nabove). This is achieved by keeping track of already processed &#x60;event_id&#x60;s – if you see the same\n&#x60;event_id&#x60; again you know you can ignore the event it corresponds to. Alternatively, you can keep\ntrack of the events &#x60;sequence&#x60;s – this string value is guaranteed to be monotonically increasing and\nyou can use it as a last processed event marker. If you stored &#x60;B&#x60; as last processed event sequence\nvalue and you receive a re-delivered event with sequence &#x60;A&#x60; that contains a value lexicographically\n\&quot;smaller\&quot; than &#x60;B&#x60; then you know you can ignore the event.\n\n# Payload authentication and integrity\n[HMAC](https://en.wikipedia.org/wiki/HMAC) is a security measure which allows you to verify the\nintegrity and authenticity of the data you’re receiving. Every request we make to your webhook\nendpoint has a header &#x60;Lune-HMAC&#x60; set. The header has to be used to validate the integrity and\nauthenticity of the payload, which ensures that the request actually comes from Lune and no one has\ntampered with it.\n\nThe header has the following format:\n\n&#x60;&#x60;&#x60;\ntimestamp&#x3D;TIMESTAMP,account&#x3D;ACCOUNT_ID,v1&#x3D;HMAC_VALUE,...\n&#x60;&#x60;&#x60;\n\nWhere:\n* &#x60;TIMESTAMP&#x60; is the current [Unix epoch](https://en.wikipedia.org/wiki/Unix_time). It is used to\nverify the message has an acceptable age.\n* &#x60;ACCOUNT_ID&#x60; is the account id associated with the webhook. It can be used to distinguish multiple\nwebhooks pointed to the same URL.\n* &#x60;HMAC_VALUE&#x60; is the value calculated in the following way:\n\n&#x60;&#x60;&#x60;\nHMAC-256(SECRET, TIMESTAMP + \&quot;.\&quot; + BODY)\n&#x60;&#x60;&#x60;\n\n* &#x60;HMAC-256&#x60; is the HMAC version using the SHA-256 hashing algorithm\n* &#x60;SECRET&#x60; is a per-webhook secret generated when the webhook is created. The secret can be\n  regenerated and fetched from the API.\n* &#x60;BODY&#x60; is the body of the incoming request\n\nLune reserves the right to send multiple &#x60;v1&#x3D;...&#x60; blocks in the header (in case there are multiple\nsecrets active) and your code has to handle that.\n\nTo verify the integrity and authenticity of the request you have to follow these steps\\:\n* (Optional) Determine which webhook is sending you data and select the appropriate &#x60;SECRET&#x60; by\nextracting the account from the header (&#x60;ACCOUNT_ID&#x60; referrenced above)\n* Extract the timestamp from the header (we call it &#x60;TIMESTAMP&#x60; from now on)\n* Verify that the &#x60;TIMESTAMP&#x60; is no more than two minutes in the past (this ensures that you don&#x27;t\n  try to process old requests). If the &#x60;TIMESTAMP&#x60; is too old you should reject the request with\n  a non-2xx status code.\n* Calculate &#x60;YOUR_HMAC &#x3D; HMAC-256(SECRET, TIMESTAMP + \&quot;.\&quot; + BODY)\n* Verify that the header contains an &#x60;v1&#x3D;...&#x60; block with value equal to your &#x60;YOUR_HMAC&#x60; value.\n\nAn HTTP request with missing or malformed &#x60;Lune-HMAC&#x60; header or for which the HMAC verification\nfails (the calculated HMAC does not match any of the HMACs in the &#x60;Lune-HMAC&#x60; header) must not be\nprocessed in any way (no action to be performed based on the payload) and must be rejected by\nreturning a non-2xx HTTP status code.\n\n# A mock webhook Request\nThe request itself consist of two headers and the payload. One of the headers is the previously mentioned HMAC header, the other is the *Content-Type* which is *application/json*.\n\nFor testing purposes, if you want to produce an example request, this can be simulated with\n&#x60;&#x60;&#x60;\ncurl &lt;WEBHOOK_URL&gt; \\\n  -H &#x27;Lune-HMAC: &lt;THE_HEADER_VALUE&gt;&#x27; \\\n  -H &#x27;Content-Type: application/json&#x27; \\\n  -X POST \\\n  -d &#x27;{\&quot;events\&quot;:[{\&quot;event_type\&quot;:\&quot;order.received\&quot;, \&quot;event_id\&quot;: 1, \&quot;data\&quot;: {\&quot;type\&quot;: \&quot;quantity\&quot;, \&quot;requested_quantity\&quot;: \&quot;1000\&quot;, \&quot;id\&quot;: \&quot;va1BER4JZqnzPkYxJgALg0GeQDoXlWO5\&quot;, \&quot;status\&quot;: \&quot;received\&quot;,\&quot;currency\&quot;: \&quot;GBP\&quot;,\&quot;created_at\&quot;: \&quot;1985-04-12T23:20:50.52Z\&quot;,\&quot;metadata\&quot;: {}}, \&quot;api_version\&quot;: \&quot;v1\&quot;},{\&quot;event_type\&quot;: \&quot;order.placed”, \&quot;event_id\&quot;: 2, \&quot;data\&quot;: {\&quot;type\&quot;: \&quot;quantity\&quot;, \&quot;requested_quantity\&quot;: \&quot;1000\&quot;, \&quot;id\&quot;: \&quot;va1BER4JZqnzPkYxJgALg0GeQDoXlWO5\&quot;, \&quot;status\&quot;: \&quot;received\&quot;,\&quot;currency\&quot;: \&quot;GBP\&quot;,\&quot;created_at\&quot;: \&quot;1985-04-12T23:20:50.52Z\&quot;,\&quot;metadata\&quot;: {}}, \&quot;api_version\&quot;: \&quot;v1\&quot;}]}&#x27;\n&#x60;&#x60;&#x60;\n\nwhere &#x60;WEBHOOK_URL&#x60; is your webhook endpoint and &#x60;THE_HEADER_VALUE&#x60; of form &#x60;timestamp&#x3D;...,v1&#x3D;...&#x60;\ncan be produced using the algorithm above.\n\n# Handling unknown event_types\nLune may introduce events with new &#x60;event_type&#x60;s. Your code should ignore unknown &#x60;event_type&#x60;s\nto make sure it remains future-proof.\n\n# The payload format\nThe &#x60;/WebhookRequest&#x60; mock endpoint documents the data format that the webhook endpoints should expect.\n&quot;
    },
    &quot;endpoints&quot;: [
        {
            &quot;method&quot;: &quot;post&quot;,
            &quot;path&quot;: &quot;/WebhookRequest&quot;,
            &quot;summary&quot;: &quot;Webhook request&quot;,
            &quot;description&quot;: &quot;The endpoint describes the request that you will receive in your webhook receiver and the responses the Lune webhook infrastructure expects.\n&quot;,
            &quot;tags&quot;: [
                &quot;Webhook Request&quot;
            ],
            &quot;requestBodySchema&quot;: {
                &quot;type&quot;: &quot;object&quot;,
                &quot;required&quot;: [
                    &quot;events&quot;
                ],
                &quot;properties&quot;: {
                    &quot;events&quot;: {
                        &quot;type&quot;: &quot;array&quot;,
                        &quot;items&quot;: {
                            &quot;type&quot;: &quot;object&quot;,
                            &quot;required&quot;: [
                                &quot;api_version&quot;,
                                &quot;event_id&quot;,
                                &quot;event_type&quot;,
                                &quot;data&quot;
                            ],
                            &quot;properties&quot;: {
                                &quot;api_version&quot;: {
                                    &quot;type&quot;: &quot;string&quot;,
                                    &quot;example&quot;: &quot;v1&quot;,
                                    &quot;description&quot;: &quot;Version of the API that serialized the event. The only possible value at the moment is &#x60;v1&#x60;.\n&quot;
                                },
                                &quot;event_id&quot;: {
                                    &quot;type&quot;: &quot;string&quot;,
                                    &quot;example&quot;: &quot;va1BER4JZqnzPkYxJgALg0GeQDoXlWO5&quot;,
                                    &quot;description&quot;: &quot;The event’s id. The id can be used for idempotency behaviour if stored on the client side.&quot;
                                },
                                &quot;event_type&quot;: {
                                    &quot;type&quot;: &quot;string&quot;,
                                    &quot;enum&quot;: [
                                        &quot;order.received&quot;,
                                        &quot;order.placed&quot;,
                                        &quot;order.allocated&quot;,
                                        &quot;order.paid&quot;,
                                        &quot;order.cancelled&quot;,
                                        &quot;order.failed&quot;,
                                        &quot;order.completed&quot;
                                    ],
                                    &quot;description&quot;: &quot;The event type. The type of event data will depend on the value present here.&quot;
                                },
                                &quot;sequence&quot;: {
                                    &quot;type&quot;: &quot;string&quot;,
                                    &quot;example&quot;: &quot;2021-09-13T16:21:29.067Z&quot;,
                                    &quot;description&quot;: &quot;The event’s sequence. This can be compared lexicographically to determine the order of events.\n\nThe details of the format are subject to change without notice as long as the lexicographical\nordering property remains intact. You can&#x27;t depend on the values having any particular shape\n(in particular you can&#x27;t depend on them being valid timestamps).\n&quot;
                                },
                                &quot;data&quot;: {
                                    &quot;type&quot;: &quot;object&quot;,
                                    &quot;required&quot;: [
                                        &quot;order&quot;
                                    ],
                                    &quot;properties&quot;: {
                                        &quot;order&quot;: {
                                            &quot;type&quot;: &quot;object&quot;,
                                            &quot;oneOf&quot;: [
                                                {
                                                    &quot;type&quot;: &quot;object&quot;,
                                                    &quot;required&quot;: [
                                                        &quot;id&quot;,
                                                        &quot;type&quot;,
                                                        &quot;status&quot;,
                                                        &quot;currency&quot;,
                                                        &quot;created_at&quot;,
                                                        &quot;metadata&quot;,
                                                        &quot;requested_quantity&quot;
                                                    ],
                                                    &quot;properties&quot;: {
                                                        &quot;id&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;The order&#x27;s unique identifier&quot;,
                                                            &quot;example&quot;: &quot;va1BER4JZqnzPkYxJgALg0GeQDoXlWO5&quot;
                                                        },
                                                        &quot;idempotency_key&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;maxLength&quot;: 100,
                                                            &quot;example&quot;: &quot;5bd808a954e&quot;,
                                                            &quot;description&quot;: &quot;Account-unique identifier provided by the client.\n\n&#x60;idempotency_key&#x60; has two purposes:\n1. Clients can safely retry order requests without accidentally performing the same operation twice. The current state of the original order is returned.\n2. Clients can use &#x60;idempotency_key&#x60; to reconcile orders with other entities on their system.\n&quot;
                                                        },
                                                        &quot;type&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;Identifies whether the order has been placed by quantity (kg CO2) or value (monetary amount)&quot;,
                                                            &quot;example&quot;: &quot;quantity&quot;,
                                                            &quot;enum&quot;: [
                                                                &quot;quantity&quot;,
                                                                &quot;value&quot;
                                                            ]
                                                        },
                                                        &quot;status&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;Order status&quot;,
                                                            &quot;example&quot;: &quot;complete&quot;,
                                                            &quot;enum&quot;: [
                                                                &quot;received&quot;,
                                                                &quot;placed&quot;,
                                                                &quot;paid&quot;,
                                                                &quot;retiring&quot;,
                                                                &quot;cancelled&quot;,
                                                                &quot;complete&quot;,
                                                                &quot;failed&quot;
                                                            ]
                                                        },
                                                        &quot;currency&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;Order currency code&quot;,
                                                            &quot;example&quot;: &quot;GBP&quot;
                                                        },
                                                        &quot;offset_cost&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;The net offset cost being purchased. May be lower than &#x60;requested_value&#x60;.\n\nThis property is set when bundles are assigned to the order.\nUnit: order currency\n&quot;,
                                                            &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                            &quot;example&quot;: &quot;7176.00&quot;
                                                        },
                                                        &quot;total_cost&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;The total cost for the order inclusive of fees.\n\nUnit: order currency\n&quot;,
                                                            &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                            &quot;example&quot;: &quot;7696.00&quot;
                                                        },
                                                        &quot;commission&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;Lune&#x27;s fee.\n\nThis property is set when bundles are assigned to the order.\nUnit: order currency\n&quot;,
                                                            &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                            &quot;example&quot;: &quot;520.00&quot;
                                                        },
                                                        &quot;quantity&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                            &quot;example&quot;: &quot;1040&quot;,
                                                            &quot;description&quot;: &quot;Quantity of CO2 offsets purchased in tonnes.&quot;
                                                        },
                                                        &quot;created_at&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;format&quot;: &quot;date-time&quot;,
                                                            &quot;description&quot;: &quot;Order creation timestamp&quot;
                                                        },
                                                        &quot;bundles&quot;: {
                                                            &quot;type&quot;: &quot;array&quot;,
                                                            &quot;description&quot;: &quot;bundles are set when the order&#x27;s status is &#x60;placed&#x60;, &#x60;paid&#x60;, &#x60;retiring&#x60; or &#x60;complete&#x60;.\n\nThe bundles associated with the order including their relative quantity and cost breakdown.\n&quot;,
                                                            &quot;items&quot;: {
                                                                &quot;type&quot;: &quot;object&quot;,
                                                                &quot;required&quot;: [
                                                                    &quot;bundle_id&quot;,
                                                                    &quot;bundle_name&quot;,
                                                                    &quot;quantity&quot;,
                                                                    &quot;unit_price&quot;,
                                                                    &quot;gross_unit_price&quot;,
                                                                    &quot;offset_cost&quot;
                                                                ],
                                                                &quot;properties&quot;: {
                                                                    &quot;bundle_id&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The bundle&#x27;s unique identifier&quot;,
                                                                        &quot;example&quot;: &quot;va1BEV2VZqnzPkYxJgALg0GeQDoXlWO5&quot;
                                                                    },
                                                                    &quot;bundle_name&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The bundle&#x27;s name&quot;,
                                                                        &quot;example&quot;: &quot;Latin America Forestry&quot;
                                                                    },
                                                                    &quot;quantity&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                                        &quot;example&quot;: &quot;1040&quot;,
                                                                        &quot;description&quot;: &quot;Quantity for the specific bundle (tonnes CO2)&quot;
                                                                    },
                                                                    &quot;unit_price&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;Bundle unit price per tonne CO2\n\nUnit: order currency\n&quot;,
                                                                        &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                                        &quot;example&quot;: &quot;6.90&quot;
                                                                    },
                                                                    &quot;gross_unit_price&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;Bundle unit price per tonne CO2 inclusive of fees.\n\nUnit: order currency\n&quot;,
                                                                        &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                                        &quot;example&quot;: &quot;7.90&quot;
                                                                    },
                                                                    &quot;offset_cost&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The bundle&#x27;s net offset cost being purchased.\n\nUnit: order currency\n&quot;,
                                                                        &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                                        &quot;example&quot;: &quot;7176.00&quot;
                                                                    },
                                                                    &quot;insufficient_available_quantity&quot;: {
                                                                        &quot;type&quot;: &quot;boolean&quot;,
                                                                        &quot;description&quot;: &quot;If true, there is no inventory necessary to fully satisfy the order for this bundle.\n&quot;,
                                                                        &quot;example&quot;: true
                                                                    }
                                                                },
                                                                &quot;ref&quot;: &quot;#/components/schemas/OrderBundle&quot;
                                                            }
                                                        },
                                                        &quot;projects&quot;: {
                                                            &quot;type&quot;: &quot;array&quot;,
                                                            &quot;description&quot;: &quot;Projects are set when the order&#x27;s status is &#x60;retiring&#x60; or &#x60;complete&#x60;.\n\nThe projects associated with the order including their relative quantity and cost breakdown.\n\nOrders are placed against bundles, not projects. Projects in a bundle may change based on supply.\n\nThis property is set as soon as we can guarantee project supply.\n&quot;,
                                                            &quot;items&quot;: {
                                                                &quot;type&quot;: &quot;object&quot;,
                                                                &quot;required&quot;: [
                                                                    &quot;project_id&quot;,
                                                                    &quot;project_name&quot;,
                                                                    &quot;project_type&quot;,
                                                                    &quot;project_slug&quot;,
                                                                    &quot;quantity&quot;,
                                                                    &quot;unit_price&quot;,
                                                                    &quot;offset_cost&quot;
                                                                ],
                                                                &quot;properties&quot;: {
                                                                    &quot;project_id&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The project&#x27;s unique identifier&quot;,
                                                                        &quot;example&quot;: &quot;xe1BEV2VZqnzPkYxJgALg0GeQDoXlWO5&quot;
                                                                    },
                                                                    &quot;project_name&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The project&#x27;s name&quot;,
                                                                        &quot;example&quot;: &quot;Alto Mayo&quot;
                                                                    },
                                                                    &quot;project_type&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The project&#x27;s offset type, eg Forest conservation, Afforestation, Direct Air Capture&quot;,
                                                                        &quot;example&quot;: &quot;Forest conservation&quot;
                                                                    },
                                                                    &quot;project_slug&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The project&#x27;s unique slug&quot;,
                                                                        &quot;example&quot;: &quot;alto-mayo&quot;
                                                                    },
                                                                    &quot;quantity&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                                        &quot;example&quot;: &quot;1040&quot;,
                                                                        &quot;description&quot;: &quot;Carbon offset purchased (tonnes CO2)&quot;
                                                                    },
                                                                    &quot;unit_price&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;Project unit price per tonne CO2\n\nUnit: order currency\n&quot;,
                                                                        &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                                        &quot;example&quot;: &quot;6.09&quot;
                                                                    },
                                                                    &quot;offset_cost&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The net offset cost being purchased.\n\nUnit: order currency\n&quot;,
                                                                        &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                                        &quot;example&quot;: &quot;7176.00&quot;
                                                                    }
                                                                },
                                                                &quot;ref&quot;: &quot;#/components/schemas/OrderProject&quot;
                                                            },
                                                            &quot;example&quot;: [
                                                                {
                                                                    &quot;quantity&quot;: &quot;600&quot;,
                                                                    &quot;unit_price&quot;: &quot;6.90&quot;,
                                                                    &quot;offset_cost&quot;: &quot;4140.00&quot;,
                                                                    &quot;project_id&quot;: &quot;gMbvJoOaX54V1wpNaRY8dWDGQ7m239Bx&quot;,
                                                                    &quot;project_name&quot;: &quot;Madre De Dios&quot;,
                                                                    &quot;project_type&quot;: &quot;Forest Conservation&quot;,
                                                                    &quot;project_slug&quot;: &quot;madre-de-dios&quot;
                                                                },
                                                                {
                                                                    &quot;quantity&quot;: &quot;440&quot;,
                                                                    &quot;unit_price&quot;: &quot;6.90&quot;,
                                                                    &quot;offset_cost&quot;: &quot;3036.00&quot;,
                                                                    &quot;project_id&quot;: &quot;xe1BEV2VZqnzPkYxJgALg0GeQDoXlWO5&quot;,
                                                                    &quot;project_name&quot;: &quot;Alto Mayo&quot;,
                                                                    &quot;project_type&quot;: &quot;Forest Conservation&quot;,
                                                                    &quot;project_slug&quot;: &quot;alto-mayo&quot;
                                                                }
                                                            ]
                                                        },
                                                        &quot;certificate&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;Carbon credits certificate URL.\n\nThis property is set when an order has state &#x27;complete&#x27;\n&quot;,
                                                            &quot;example&quot;: &quot;https://api.lune.co/v1/orders/08QD7GPaBx5b6Y60ndAONXLvrZljRE2e/certificate&quot;
                                                        },
                                                        &quot;metadata&quot;: {
                                                            &quot;description&quot;: &quot;An arbitrary dictionary (key-value pairs) to store application-specific information.\n\nLune doesn&#x27;t use this information for order processing. Its purpose is for the API\nclients to be able to attach arbitrary information (to an order for example) and\nthen retrieve it.\n&quot;,
                                                            &quot;type&quot;: &quot;object&quot;,
                                                            &quot;additionalProperties&quot;: {
                                                                &quot;type&quot;: &quot;string&quot;
                                                            },
                                                            &quot;ref&quot;: &quot;#/components/schemas/Metadata&quot;
                                                        },
                                                        &quot;offset_link_id&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;The offset link identifier, if the order was placed through an offset link&quot;,
                                                            &quot;example&quot;: &quot;UwjfkXjfksoHXzA1qjANL58GhjwqkxpB&quot;
                                                        },
                                                        &quot;email&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;End-user email.\n\nThis property is currently populated on orders placed through offset links.\n&quot;,
                                                            &quot;example&quot;: &quot;john@doe.com&quot;
                                                        },
                                                        &quot;requested_quantity&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                            &quot;example&quot;: &quot;1045&quot;,
                                                            &quot;description&quot;: &quot;Requested quantity of CO2 offsets to purchase in tonnes.&quot;
                                                        }
                                                    },
                                                    &quot;description&quot;: &quot;Order object&quot;,
                                                    &quot;ref&quot;: &quot;#/components/schemas/OrderByQuantity&quot;,
                                                    &quot;title&quot;: &quot;Order by quantity&quot;
                                                },
                                                {
                                                    &quot;type&quot;: &quot;object&quot;,
                                                    &quot;required&quot;: [
                                                        &quot;id&quot;,
                                                        &quot;type&quot;,
                                                        &quot;status&quot;,
                                                        &quot;currency&quot;,
                                                        &quot;created_at&quot;,
                                                        &quot;metadata&quot;,
                                                        &quot;requested_value&quot;
                                                    ],
                                                    &quot;properties&quot;: {
                                                        &quot;id&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;The order&#x27;s unique identifier&quot;,
                                                            &quot;example&quot;: &quot;va1BER4JZqnzPkYxJgALg0GeQDoXlWO5&quot;
                                                        },
                                                        &quot;idempotency_key&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;maxLength&quot;: 100,
                                                            &quot;example&quot;: &quot;5bd808a954e&quot;,
                                                            &quot;description&quot;: &quot;Account-unique identifier provided by the client.\n\n&#x60;idempotency_key&#x60; has two purposes:\n1. Clients can safely retry order requests without accidentally performing the same operation twice. The current state of the original order is returned.\n2. Clients can use &#x60;idempotency_key&#x60; to reconcile orders with other entities on their system.\n&quot;
                                                        },
                                                        &quot;type&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;Identifies whether the order has been placed by quantity (kg CO2) or value (monetary amount)&quot;,
                                                            &quot;example&quot;: &quot;quantity&quot;,
                                                            &quot;enum&quot;: [
                                                                &quot;quantity&quot;,
                                                                &quot;value&quot;
                                                            ]
                                                        },
                                                        &quot;status&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;Order status&quot;,
                                                            &quot;example&quot;: &quot;complete&quot;,
                                                            &quot;enum&quot;: [
                                                                &quot;received&quot;,
                                                                &quot;placed&quot;,
                                                                &quot;paid&quot;,
                                                                &quot;retiring&quot;,
                                                                &quot;cancelled&quot;,
                                                                &quot;complete&quot;,
                                                                &quot;failed&quot;
                                                            ]
                                                        },
                                                        &quot;currency&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;Order currency code&quot;,
                                                            &quot;example&quot;: &quot;GBP&quot;
                                                        },
                                                        &quot;offset_cost&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;The net offset cost being purchased. May be lower than &#x60;requested_value&#x60;.\n\nThis property is set when bundles are assigned to the order.\nUnit: order currency\n&quot;,
                                                            &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                            &quot;example&quot;: &quot;7176.00&quot;
                                                        },
                                                        &quot;total_cost&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;The total cost for the order inclusive of fees.\n\nUnit: order currency\n&quot;,
                                                            &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                            &quot;example&quot;: &quot;7696.00&quot;
                                                        },
                                                        &quot;commission&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;Lune&#x27;s fee.\n\nThis property is set when bundles are assigned to the order.\nUnit: order currency\n&quot;,
                                                            &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                            &quot;example&quot;: &quot;520.00&quot;
                                                        },
                                                        &quot;quantity&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                            &quot;example&quot;: &quot;1040&quot;,
                                                            &quot;description&quot;: &quot;Quantity of CO2 offsets purchased in tonnes.&quot;
                                                        },
                                                        &quot;created_at&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;format&quot;: &quot;date-time&quot;,
                                                            &quot;description&quot;: &quot;Order creation timestamp&quot;
                                                        },
                                                        &quot;bundles&quot;: {
                                                            &quot;type&quot;: &quot;array&quot;,
                                                            &quot;description&quot;: &quot;bundles are set when the order&#x27;s status is &#x60;placed&#x60;, &#x60;paid&#x60;, &#x60;retiring&#x60; or &#x60;complete&#x60;.\n\nThe bundles associated with the order including their relative quantity and cost breakdown.\n&quot;,
                                                            &quot;items&quot;: {
                                                                &quot;type&quot;: &quot;object&quot;,
                                                                &quot;required&quot;: [
                                                                    &quot;bundle_id&quot;,
                                                                    &quot;bundle_name&quot;,
                                                                    &quot;quantity&quot;,
                                                                    &quot;unit_price&quot;,
                                                                    &quot;gross_unit_price&quot;,
                                                                    &quot;offset_cost&quot;
                                                                ],
                                                                &quot;properties&quot;: {
                                                                    &quot;bundle_id&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The bundle&#x27;s unique identifier&quot;,
                                                                        &quot;example&quot;: &quot;va1BEV2VZqnzPkYxJgALg0GeQDoXlWO5&quot;
                                                                    },
                                                                    &quot;bundle_name&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The bundle&#x27;s name&quot;,
                                                                        &quot;example&quot;: &quot;Latin America Forestry&quot;
                                                                    },
                                                                    &quot;quantity&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                                        &quot;example&quot;: &quot;1040&quot;,
                                                                        &quot;description&quot;: &quot;Quantity for the specific bundle (tonnes CO2)&quot;
                                                                    },
                                                                    &quot;unit_price&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;Bundle unit price per tonne CO2\n\nUnit: order currency\n&quot;,
                                                                        &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                                        &quot;example&quot;: &quot;6.90&quot;
                                                                    },
                                                                    &quot;gross_unit_price&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;Bundle unit price per tonne CO2 inclusive of fees.\n\nUnit: order currency\n&quot;,
                                                                        &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                                        &quot;example&quot;: &quot;7.90&quot;
                                                                    },
                                                                    &quot;offset_cost&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The bundle&#x27;s net offset cost being purchased.\n\nUnit: order currency\n&quot;,
                                                                        &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                                        &quot;example&quot;: &quot;7176.00&quot;
                                                                    },
                                                                    &quot;insufficient_available_quantity&quot;: {
                                                                        &quot;type&quot;: &quot;boolean&quot;,
                                                                        &quot;description&quot;: &quot;If true, there is no inventory necessary to fully satisfy the order for this bundle.\n&quot;,
                                                                        &quot;example&quot;: true
                                                                    }
                                                                },
                                                                &quot;ref&quot;: &quot;#/components/schemas/OrderBundle&quot;
                                                            }
                                                        },
                                                        &quot;projects&quot;: {
                                                            &quot;type&quot;: &quot;array&quot;,
                                                            &quot;description&quot;: &quot;Projects are set when the order&#x27;s status is &#x60;retiring&#x60; or &#x60;complete&#x60;.\n\nThe projects associated with the order including their relative quantity and cost breakdown.\n\nOrders are placed against bundles, not projects. Projects in a bundle may change based on supply.\n\nThis property is set as soon as we can guarantee project supply.\n&quot;,
                                                            &quot;items&quot;: {
                                                                &quot;type&quot;: &quot;object&quot;,
                                                                &quot;required&quot;: [
                                                                    &quot;project_id&quot;,
                                                                    &quot;project_name&quot;,
                                                                    &quot;project_type&quot;,
                                                                    &quot;project_slug&quot;,
                                                                    &quot;quantity&quot;,
                                                                    &quot;unit_price&quot;,
                                                                    &quot;offset_cost&quot;
                                                                ],
                                                                &quot;properties&quot;: {
                                                                    &quot;project_id&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The project&#x27;s unique identifier&quot;,
                                                                        &quot;example&quot;: &quot;xe1BEV2VZqnzPkYxJgALg0GeQDoXlWO5&quot;
                                                                    },
                                                                    &quot;project_name&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The project&#x27;s name&quot;,
                                                                        &quot;example&quot;: &quot;Alto Mayo&quot;
                                                                    },
                                                                    &quot;project_type&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The project&#x27;s offset type, eg Forest conservation, Afforestation, Direct Air Capture&quot;,
                                                                        &quot;example&quot;: &quot;Forest conservation&quot;
                                                                    },
                                                                    &quot;project_slug&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The project&#x27;s unique slug&quot;,
                                                                        &quot;example&quot;: &quot;alto-mayo&quot;
                                                                    },
                                                                    &quot;quantity&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                                        &quot;example&quot;: &quot;1040&quot;,
                                                                        &quot;description&quot;: &quot;Carbon offset purchased (tonnes CO2)&quot;
                                                                    },
                                                                    &quot;unit_price&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;Project unit price per tonne CO2\n\nUnit: order currency\n&quot;,
                                                                        &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                                        &quot;example&quot;: &quot;6.09&quot;
                                                                    },
                                                                    &quot;offset_cost&quot;: {
                                                                        &quot;type&quot;: &quot;string&quot;,
                                                                        &quot;description&quot;: &quot;The net offset cost being purchased.\n\nUnit: order currency\n&quot;,
                                                                        &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                                        &quot;example&quot;: &quot;7176.00&quot;
                                                                    }
                                                                },
                                                                &quot;ref&quot;: &quot;#/components/schemas/OrderProject&quot;
                                                            },
                                                            &quot;example&quot;: [
                                                                {
                                                                    &quot;quantity&quot;: &quot;600&quot;,
                                                                    &quot;unit_price&quot;: &quot;6.90&quot;,
                                                                    &quot;offset_cost&quot;: &quot;4140.00&quot;,
                                                                    &quot;project_id&quot;: &quot;gMbvJoOaX54V1wpNaRY8dWDGQ7m239Bx&quot;,
                                                                    &quot;project_name&quot;: &quot;Madre De Dios&quot;,
                                                                    &quot;project_type&quot;: &quot;Forest Conservation&quot;,
                                                                    &quot;project_slug&quot;: &quot;madre-de-dios&quot;
                                                                },
                                                                {
                                                                    &quot;quantity&quot;: &quot;440&quot;,
                                                                    &quot;unit_price&quot;: &quot;6.90&quot;,
                                                                    &quot;offset_cost&quot;: &quot;3036.00&quot;,
                                                                    &quot;project_id&quot;: &quot;xe1BEV2VZqnzPkYxJgALg0GeQDoXlWO5&quot;,
                                                                    &quot;project_name&quot;: &quot;Alto Mayo&quot;,
                                                                    &quot;project_type&quot;: &quot;Forest Conservation&quot;,
                                                                    &quot;project_slug&quot;: &quot;alto-mayo&quot;
                                                                }
                                                            ]
                                                        },
                                                        &quot;certificate&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;Carbon credits certificate URL.\n\nThis property is set when an order has state &#x27;complete&#x27;\n&quot;,
                                                            &quot;example&quot;: &quot;https://api.lune.co/v1/orders/08QD7GPaBx5b6Y60ndAONXLvrZljRE2e/certificate&quot;
                                                        },
                                                        &quot;metadata&quot;: {
                                                            &quot;description&quot;: &quot;An arbitrary dictionary (key-value pairs) to store application-specific information.\n\nLune doesn&#x27;t use this information for order processing. Its purpose is for the API\nclients to be able to attach arbitrary information (to an order for example) and\nthen retrieve it.\n&quot;,
                                                            &quot;type&quot;: &quot;object&quot;,
                                                            &quot;additionalProperties&quot;: {
                                                                &quot;type&quot;: &quot;string&quot;
                                                            },
                                                            &quot;ref&quot;: &quot;#/components/schemas/Metadata&quot;
                                                        },
                                                        &quot;offset_link_id&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;The offset link identifier, if the order was placed through an offset link&quot;,
                                                            &quot;example&quot;: &quot;UwjfkXjfksoHXzA1qjANL58GhjwqkxpB&quot;
                                                        },
                                                        &quot;email&quot;: {
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;description&quot;: &quot;End-user email.\n\nThis property is currently populated on orders placed through offset links.\n&quot;,
                                                            &quot;example&quot;: &quot;john@doe.com&quot;
                                                        },
                                                        &quot;requested_value&quot;: {
                                                            &quot;description&quot;: &quot;Requested value of CO2 offsets to purchase in the account&#x27;s currency.&quot;,
                                                            &quot;type&quot;: &quot;string&quot;,
                                                            &quot;pattern&quot;: &quot;^[0-9]+(\\.[0-9]+)?$&quot;,
                                                            &quot;example&quot;: &quot;7700&quot;
                                                        }
                                                    },
                                                    &quot;description&quot;: &quot;Order object&quot;,
                                                    &quot;ref&quot;: &quot;#/components/schemas/OrderByValue&quot;,
                                                    &quot;title&quot;: &quot;Order by value&quot;
                                                }
                                            ],
                                            &quot;discriminator&quot;: {
                                                &quot;propertyName&quot;: &quot;type&quot;,
                                                &quot;mapping&quot;: {
                                                    &quot;quantity&quot;: &quot;#/components/schemas/OrderByQuantity&quot;,
                                                    &quot;value&quot;: &quot;#/components/schemas/OrderByValue&quot;
                                                }
                                            },
                                            &quot;ref&quot;: &quot;#/components/schemas/Order&quot;
                                        }
                                    },
                                    &quot;ref&quot;: &quot;#/components/schemas/OrderEventDetails&quot;
                                }
                            },
                            &quot;ref&quot;: &quot;#/components/schemas/WebhookEvent&quot;
                        }
                    }
                },
                &quot;ref&quot;: &quot;#/components/schemas/WebhookRequest&quot;
            },
            &quot;requestBodyExample&quot;: {
                &quot;events&quot;: [
                    {
                        &quot;api_version&quot;: &quot;v1&quot;,
                        &quot;event_id&quot;: &quot;va1BER4JZqnzPkYxJgALg0GeQDoXlWO5&quot;,
                        &quot;event_type&quot;: &quot;string&quot;,
                        &quot;sequence&quot;: &quot;2021-09-13T16:21:29.067Z&quot;,
                        &quot;data&quot;: {
                            &quot;order&quot;: {
                                &quot;id&quot;: &quot;va1BER4JZqnzPkYxJgALg0GeQDoXlWO5&quot;,
                                &quot;idempotency_key&quot;: &quot;5bd808a954e&quot;,
                                &quot;type&quot;: &quot;quantity&quot;,
                                &quot;status&quot;: &quot;complete&quot;,
                                &quot;currency&quot;: &quot;GBP&quot;,
                                &quot;offset_cost&quot;: &quot;7176.00&quot;,
                                &quot;total_cost&quot;: &quot;7696.00&quot;,
                                &quot;commission&quot;: &quot;520.00&quot;,
                                &quot;quantity&quot;: &quot;1040&quot;,
                                &quot;created_at&quot;: &quot;string&quot;,
                                &quot;bundles&quot;: [
                                    {
                                        &quot;bundle_id&quot;: &quot;va1BEV2VZqnzPkYxJgALg0GeQDoXlWO5&quot;,
                                        &quot;bundle_name&quot;: &quot;Latin America Forestry&quot;,
                                        &quot;quantity&quot;: &quot;1040&quot;,
                                        &quot;unit_price&quot;: &quot;6.90&quot;,
                                        &quot;gross_unit_price&quot;: &quot;7.90&quot;,
                                        &quot;offset_cost&quot;: &quot;7176.00&quot;,
                                        &quot;insufficient_available_quantity&quot;: true
                                    }
                                ],
                                &quot;projects&quot;: [
                                    {
                                        &quot;quantity&quot;: &quot;600&quot;,
                                        &quot;unit_price&quot;: &quot;6.90&quot;,
                                        &quot;offset_cost&quot;: &quot;4140.00&quot;,
                                        &quot;project_id&quot;: &quot;gMbvJoOaX54V1wpNaRY8dWDGQ7m239Bx&quot;,
                                        &quot;project_name&quot;: &quot;Madre De Dios&quot;,
                                        &quot;project_type&quot;: &quot;Forest Conservation&quot;,
                                        &quot;project_slug&quot;: &quot;madre-de-dios&quot;
                                    },
                                    {
                                        &quot;quantity&quot;: &quot;440&quot;,
                                        &quot;unit_price&quot;: &quot;6.90&quot;,
                                        &quot;offset_cost&quot;: &quot;3036.00&quot;,
                                        &quot;project_id&quot;: &quot;xe1BEV2VZqnzPkYxJgALg0GeQDoXlWO5&quot;,
                                        &quot;project_name&quot;: &quot;Alto Mayo&quot;,
                                        &quot;project_type&quot;: &quot;Forest Conservation&quot;,
                                        &quot;project_slug&quot;: &quot;alto-mayo&quot;
                                    }
                                ],
                                &quot;certificate&quot;: &quot;https://api.lune.co/v1/orders/08QD7GPaBx5b6Y60ndAONXLvrZljRE2e/certificate&quot;,
                                &quot;metadata&quot;: {
                                    &quot;property1&quot;: &quot;string&quot;,
                                    &quot;property2&quot;: &quot;number&quot;
                                },
                                &quot;offset_link_id&quot;: &quot;UwjfkXjfksoHXzA1qjANL58GhjwqkxpB&quot;,
                                &quot;email&quot;: &quot;john@doe.com&quot;,
                                &quot;requested_quantity&quot;: &quot;1045&quot;
                            }
                        }
                    }
                ]
            },
            &quot;requestBodyRef&quot;: &quot;#/components/schemas/WebhookRequest&quot;,
            &quot;pathParameters&quot;: [],
            &quot;queryParameters&quot;: [],
            &quot;responses&quot;: {
                &quot;200&quot;: {
                    &quot;description&quot;: &quot;The events have been successfully handled. Any status code of the &#x60;2xx&#x60; format has the same behaviour. Any header or body are ignored by Lune.&quot;
                }
            }
        }
    ]
}"/>
